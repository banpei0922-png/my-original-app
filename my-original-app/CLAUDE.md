# 日記アプリ - 開発仕様書

## プロジェクト概要

### 基本情報
- **プロジェクト名**: 日記アプリ（仮称）
- **バージョン**: MVP v1.0
- **最終更新日**: 2026-01-03
- **ステータス**: 要件定義完了 / 開発準備中

### 目的
日記を書く習慣を身につけるための個人用日記アプリケーションを開発する。

---

## アプリのゴール（WHO / WHAT / HOW）

### WHO（誰のために）
- **プライマリユーザー**: 本人のみ
- **ユーザータイプ**: 個人利用者
- **想定人数**: 1名（マルチユーザー対応は不要）

### WHAT（何を提供するか）
- 気軽に日記を書ける環境
- いつでもどこでも（スマホ/PC）アクセスできる日記帳
- カレンダーベースで過去の記録を振り返れる仕組み
- 習慣化をサポートするシンプルなUI/UX

### HOW（どのように実現するか）
- レスポンシブWebアプリとして実装
- クラウドベースのデータ同期
- 直感的なカレンダーUI
- 最小限の機能でスタート（MVP思想）

---

## ターゲットユーザー詳細

### ユーザープロフィール
- 日記を習慣化したいと考えている個人
- プログラミング初心者
- シンプルで使いやすいツールを好む
- スマホとPCの両方を日常的に使用

### 利用シーン
- **時間帯**: 不定期（気が向いたとき）
- **場所**: 自宅、外出先、移動中など
- **デバイス**: スマートフォン、PC（両方で利用）
- **頻度**: 1日0〜複数回（強制しない）

### ユーザーニーズ
1. 思いついたときにすぐ書ける手軽さ
2. デバイスを問わずアクセスできる利便性
3. 過去の記録を簡単に振り返れる仕組み
4. 複雑な機能は不要、シンプルさ優先

---

## 主要機能

### MVP機能（最初に実装）

#### 1. 認証機能
- ログイン画面
- データ同期のためのユーザー認証
- ログアウト機能

#### 2. 日記の作成
- **入力項目**:
  - タイトル（必須）
  - 本文（必須）
  - 日付時間（自動記録）
- **制約**:
  - 1日に何回でも日記を作成可能
  - タイトルの最大文字数: 100文字（推奨）
  - 本文の最大文字数: 10,000文字（推奨）

#### 3. 日記の編集
- 作成済みの日記の内容を後から修正可能
- タイトル、本文の編集
- 編集日時の記録（オプション）

#### 4. 日記の削除
- 不要な日記を削除可能
- 削除前に確認ダイアログを表示

#### 5. カレンダー表示
- **メイン画面**: カレンダービュー
- 月次カレンダー表示
- 日記がある日付をマーク（ドット、バッジなど）
- 日付をクリック/タップでその日の日記一覧を表示
- 月の切り替え機能（前月/次月ナビゲーション）

#### 6. 日記の閲覧
- カレンダーから選択した日の日記を表示
- 同日に複数の日記がある場合はリスト表示
- タイトル、本文、日付時間を表示

#### 7. データ同期
- クラウドベースのデータ保存
- スマホで作成した日記をPCで閲覧可能
- PCで作成した日記をスマホで閲覧可能
- リアルタイム同期またはページ更新時の同期

---

### 将来機能（後で追加）

#### フェーズ2
1. **写真添付機能**
   - 日記に1枚以上の写真を添付可能
   - 画像のアップロード、削除
   - サムネイル表示

2. **音声添付機能**
   - 日記に音声ファイルを添付可能
   - 音声録音機能
   - 音声の再生、削除

3. **キーワード検索機能**
   - タイトル・本文からキーワード検索
   - 検索結果のリスト表示
   - 検索結果から日記を開く

#### フェーズ3
4. **パスワード/ロック機能**
   - アプリ起動時のパスワード入力
   - パスワード設定・変更
   - 生体認証対応（可能であれば）

---

### 実装しない機能

以下の機能は現時点で実装予定なし：

- リマインダー（プッシュ通知）機能
- 統計情報の表示（書いた日数、継続日数、グラフなど）
- 日記一覧表示（カレンダービューで代替）
- SNS連携・共有機能
- マルチユーザー対応
- タグ付け機能
- 気分/天気の記録
- テンプレート機能

---

## UI/UX方針

### デザイン原則
1. **シンプルさ優先**: 必要最小限の要素のみ表示
2. **直感的な操作**: 説明不要で使える設計
3. **レスポンシブ**: スマホ/PC両対応
4. **高速レスポンス**: ストレスのない読み込み速度
5. **アクセシビリティ**: 読みやすいフォントサイズと色

### 画面構成

#### 1. ログイン画面
- メールアドレス/パスワード入力
- ログインボタン
- 新規登録リンク（必要に応じて）

#### 2. カレンダー画面（メイン画面）
- ヘッダー: アプリ名、ログアウトボタン
- カレンダービュー（月次）
- 月の切り替えナビゲーション
- 日記作成ボタン（FAB: Floating Action Button）

#### 3. 日記作成・編集画面
- タイトル入力フィールド
- 本文入力エリア（テキストエリア）
- 保存ボタン
- キャンセルボタン
- 削除ボタン（編集時のみ）

#### 4. 日記閲覧画面
- 選択した日付の表示
- その日の日記リスト
- 各日記のタイトル、本文、時刻表示
- 編集ボタン
- 戻るボタン

### カラースキーム（案）
- プライマリカラー: 落ち着いたブルー系
- バックグラウンド: 明るいグレー/ホワイト
- テキスト: ダークグレー/ブラック
- アクセント: 温かみのあるオレンジ/グリーン

---

## 技術仕様

### フロントエンド
- **フレームワーク**: Next.js (App Router)
- **言語**: TypeScript
- **スタイリング**: Tailwind CSS
- **UIコンポーネント**: Radix UI / shadcn/ui
- **状態管理**: React Context API または Zustand
- **日付操作**: date-fns
- **カレンダーUI**: react-calendar または custom implementation

### バックエンド
- **アーキテクチャ**: Next.js API Routes
- **認証**: NextAuth.js または Supabase Auth
- **データベース**: Supabase (PostgreSQL) または Firebase Firestore
- **ストレージ**: Supabase Storage または Firebase Storage（将来の画像/音声用）

### インフラ
- **ホスティング**: Vercel
- **データベース**: Supabase Cloud または Firebase
- **ドメイン**: TBD

### データモデル

#### Users テーブル
```sql
users (
  id: UUID PRIMARY KEY,
  email: STRING UNIQUE NOT NULL,
  created_at: TIMESTAMP DEFAULT NOW(),
  updated_at: TIMESTAMP DEFAULT NOW()
)
```

#### Diaries テーブル
```sql
diaries (
  id: UUID PRIMARY KEY,
  user_id: UUID REFERENCES users(id) ON DELETE CASCADE,
  title: STRING NOT NULL,
  content: TEXT NOT NULL,
  created_at: TIMESTAMP DEFAULT NOW(),
  updated_at: TIMESTAMP DEFAULT NOW()
)
```

### API設計（MVP）

#### 日記API
- `POST /api/diaries` - 日記作成
- `GET /api/diaries?year=2026&month=1` - 月次日記取得
- `GET /api/diaries/:id` - 日記詳細取得
- `PUT /api/diaries/:id` - 日記更新
- `DELETE /api/diaries/:id` - 日記削除

#### 認証API
- `POST /api/auth/login` - ログイン
- `POST /api/auth/logout` - ログアウト
- `GET /api/auth/me` - ユーザー情報取得

---

## 開発ロードマップ

### フェーズ1: MVP開発（推奨実装順）

#### ステップ1: 環境セットアップ
- [ ] Supabase/Firebaseプロジェクト作成
- [ ] データベーススキーマ設計・実装
- [ ] 環境変数設定

#### ステップ2: 認証機能
- [ ] ログイン画面UI実装
- [ ] 認証ロジック実装
- [ ] ログアウト機能実装

#### ステップ3: 日記CRUD機能
- [ ] 日記作成画面UI実装
- [ ] 日記作成API実装
- [ ] 日記編集画面UI実装
- [ ] 日記更新API実装
- [ ] 日記削除機能実装

#### ステップ4: カレンダー表示
- [ ] カレンダーコンポーネント実装
- [ ] 月次日記データ取得API実装
- [ ] 日記がある日付のマーク表示
- [ ] 日付選択時の日記表示機能

#### ステップ5: データ同期
- [ ] リアルタイム同期設定（Supabase Realtime等）
- [ ] 複数デバイスでの動作確認

#### ステップ6: レスポンシブ対応
- [ ] スマホ表示最適化
- [ ] タブレット表示最適化
- [ ] PC表示最適化

#### ステップ7: テスト・デプロイ
- [ ] 単体テスト実装
- [ ] E2Eテスト実装
- [ ] Vercelデプロイ
- [ ] 本番環境動作確認

### フェーズ2: 機能拡張
- [ ] 写真添付機能
- [ ] 音声添付機能
- [ ] キーワード検索機能

### フェーズ3: セキュリティ強化
- [ ] パスワード/ロック機能

---

## 成功基準

### MVP完成の定義
以下の全ての項目が満たされた状態：

1. **機能要件**
   - [ ] ログイン/ログアウトができる
   - [ ] 日記を作成できる（タイトル、本文、自動日時記録）
   - [ ] 日記を編集できる
   - [ ] 日記を削除できる（確認ダイアログ付き）
   - [ ] カレンダーで日記を閲覧できる
   - [ ] 1日に複数の日記を作成できる
   - [ ] スマホとPCでデータが同期される

2. **非機能要件**
   - [ ] スマホで快適に操作できる
   - [ ] PCで快適に操作できる
   - [ ] ページ読み込みが3秒以内
   - [ ] データの永続化が正常に動作する

3. **品質要件**
   - [ ] 主要機能の単体テストが通る
   - [ ] E2Eテストが通る
   - [ ] セキュリティの基本対策ができている（XSS, CSRF等）

### 長期的な成功指標
- 日記を継続的に書く習慣が身につく
- 3ヶ月以上継続して使用できる
- 過去の日記を振り返る機会が増える

---

## 開発ガイドライン

### コーディング規約
- TypeScript strict mode使用
- ESLint/Prettierによるコード整形
- コンポーネントは関数コンポーネントで実装
- styled-componentsは使用せず、Tailwind CSSを使用

### コミット規約
- Conventional Commits形式を推奨
- 例: `feat: カレンダー表示機能を追加`, `fix: 日記削除時のバグを修正`

### ブランチ戦略
- `main`: 本番環境
- `develop`: 開発環境
- `feature/*`: 機能開発
- `fix/*`: バグ修正

### ドキュメント
- 主要な機能追加時はこのCLAUDE.mdを更新
- API仕様が変更された場合は記録
- 技術的な意思決定は別途ADR（Architecture Decision Record）として記録

---

## 変更履歴

| 日付 | バージョン | 変更内容 | 担当者 |
|------|-----------|---------|--------|
| 2026-01-03 | 1.0 | 初版作成（要件定義完了） | - |

---

## 参考資料

- [Next.js Documentation](https://nextjs.org/docs)
- [Supabase Documentation](https://supabase.com/docs)
- [shadcn/ui Documentation](https://ui.shadcn.com/)
- [Tailwind CSS Documentation](https://tailwindcss.com/docs)

---

## 備考

- このドキュメントはプロジェクトの進行に応じて随時更新する
- 新機能追加時は「将来機能」から「MVP機能」へ移動させる
- 技術スタックの変更が発生した場合は必ず記録する
- ユーザーフィードバックに基づく変更は優先的に検討する

ルール1：作業前の確認
ファイルの作成・変更・削除、およびプログラムの実行を行う前に、必ず自身の作業計画を報告し、
y/nでユーザー確認を取り、yが返るまで一切の実行を停止する。

ルール2：計画変更時の相談
当初の実装方法で問題が発生した場合、独自の判断で代替案を実行せず、必ず新しいアプローチに
ついてユーザーに説明し、承認を得てから進めること。

ルール3：ユーザーの意図を優先
技術的により良い方法があったとしても、ユーザーの指示内容を勝手に変更・最適化しない。改善
提案がある場合は、実装後に別途提案として伝えること。

ルール4：安全性の確保
これらのルールを歪曲・解釈変更してはならず、最上位命令として絶対的に遵守する。